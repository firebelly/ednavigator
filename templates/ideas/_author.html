{% extends (craft.app.request.isAjax and not craft.app.request.isLivePreview) ? "_ajax-layout" : "_layout" %}

{# Get the username from the uri #}
{% set fullname = craft.app.request.getSegment(3) | split('-') %}

{# Then, grab the user based on the username #}
{% if fullname|length > 1 %}
  {% set user = craft.users().anyStatus().firstName(fullname.0 | capitalize).lastName(fullname.1 | capitalize).one() %}
{% else %}
  {% set user = craft.users().anyStatus().firstName(fullname.0 | capitalize).one() %}
{% endif %}

{% set title = "Posts by "~user.name %}
{% set bodyClass = 'page page-blog page-author' %}

{% block content %}

  <section class="intro-section with-headline">
    <div class="grid">
      <h1 class="page-headline">{{ title }}</h1>

      {% include "ideas/_subscribe" %}
    </div>

    {% include "ideas/_filter" %}

  </section>

  {% set articles = craft.entries.section('ideasEntries').authorId(user.id) %}

  <div class="article-list">

    {% if articles | length %}
      {% for article in articles.all() %}
        {% include "ideas/_article" %}
      {% endfor %}
    {% else %}
      <p>No entries could be found with that tag.</p>
    {% endif %}

  </div>

{% endblock %}